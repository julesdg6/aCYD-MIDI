{"version":3,"file":"index-BboSheKM.js","sources":["../../src/eventBus.ts","../../src/types.ts","../../src/bleMidi.ts","../../src/serial.ts","../../src/logger.ts","../../src/controller.ts","../../src/main.ts"],"sourcesContent":["import type { LogEntry } from './types';\n\n// ============================================================\n// EventBus - Central event system for all log entries\n// ============================================================\n\ntype EventCallback = (entry: LogEntry) => void;\n\nexport class EventBus {\n  private listeners: EventCallback[] = [];\n  private t0: number;\n\n  constructor() {\n    this.t0 = performance.now();\n  }\n\n  subscribe(callback: EventCallback): () => void {\n    this.listeners.push(callback);\n    return () => {\n      const index = this.listeners.indexOf(callback);\n      if (index > -1) {\n        this.listeners.splice(index, 1);\n      }\n    };\n  }\n\n  emit(entry: Omit<LogEntry, 'id' | 'tAbsMs' | 'tRelMs'>): void {\n    const fullEntry: LogEntry = {\n      id: this.generateId(),\n      tAbsMs: Date.now(),\n      tRelMs: performance.now() - this.t0,\n      ...entry,\n    };\n\n    this.listeners.forEach(callback => callback(fullEntry));\n  }\n\n  private generateId(): string {\n    return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n  }\n\n  reset(): void {\n    this.t0 = performance.now();\n  }\n}\n","// ============================================================\n// Data Models\n// ============================================================\n\nexport type LogSource =\n  | \"UI_TO_MIDI\"\n  | \"BLE_IN\"\n  | \"BLE_OUT\"\n  | \"SERIAL_IN\"\n  | \"SERIAL_OUT\";\n\nexport type MidiKind =\n  | \"NOTE_ON\"\n  | \"NOTE_OFF\"\n  | \"CC\"\n  | \"PC\"\n  | \"PB\"\n  | \"CLOCK\"\n  | \"START\"\n  | \"STOP\"\n  | \"CONTINUE\"\n  | \"SYSEX\"\n  | \"OTHER\";\n\nexport interface MidiData {\n  kind: MidiKind;\n  channel?: number;\n  data: number[];\n  note?: number;\n  vel?: number;\n  cc?: number;\n  value?: number;\n  program?: number;\n  pitchBend?: number;\n}\n\nexport interface SerialData {\n  line: string;\n}\n\nexport interface LogEntry {\n  id: string;\n  tAbsMs: number;      // Date.now()\n  tRelMs: number;      // performance.now() - t0\n  tDeltaMs: number;    // since previous entry\n  source: LogSource;\n  text: string;        // human-readable line\n  midi?: MidiData;\n  serial?: SerialData;\n}\n\n// ============================================================\n// Settings\n// ============================================================\n\nexport interface AppSettings {\n  midiChannel: number;\n  ccMapping: {\n    cutoff: number;\n    resonance: number;\n    envMod: number;\n    decay: number;\n    accent: number;\n    volume: number;\n  };\n  accentMode: \"velocity\" | \"cc\";\n  accentVelocity: number;\n  accentCC: number;\n  accentValue: number;\n  slideMode: \"legato\" | \"cc\";\n  slideCC: number;\n  serialBaudRate: number;\n  logMaxEntries: number;\n  showRawBytes: boolean;\n  showDeltaTimes: boolean;\n}\n\nexport const DEFAULT_SETTINGS: AppSettings = {\n  midiChannel: 1,\n  ccMapping: {\n    cutoff: 74,\n    resonance: 71,\n    envMod: 75,\n    decay: 76,\n    accent: 77,\n    volume: 7,\n  },\n  accentMode: \"velocity\",\n  accentVelocity: 120,\n  accentCC: 77,\n  accentValue: 127,\n  slideMode: \"legato\",\n  slideCC: 65,\n  serialBaudRate: 115200,\n  logMaxEntries: 10000,\n  showRawBytes: false,\n  showDeltaTimes: true,\n};\n\n// ============================================================\n// MIDI Utilities\n// ============================================================\n\nexport function midiNoteToName(note: number): string {\n  const names = [\"C\", \"C#\", \"D\", \"D#\", \"E\", \"F\", \"F#\", \"G\", \"G#\", \"A\", \"A#\", \"B\"];\n  const octave = Math.floor(note / 12) - 1;\n  const noteName = names[note % 12];\n  return `${noteName}${octave}`;\n}\n\nexport function parseMidiMessage(data: number[]): MidiData {\n  if (data.length === 0) {\n    return { kind: \"OTHER\", data };\n  }\n\n  const status = data[0];\n  const messageType = status & 0xf0;\n  const channel = (status & 0x0f) + 1;\n\n  switch (messageType) {\n    case 0x90: // Note On\n      return {\n        kind: data[2] > 0 ? \"NOTE_ON\" : \"NOTE_OFF\",\n        channel,\n        data,\n        note: data[1],\n        vel: data[2],\n      };\n\n    case 0x80: // Note Off\n      return {\n        kind: \"NOTE_OFF\",\n        channel,\n        data,\n        note: data[1],\n        vel: data[2],\n      };\n\n    case 0xb0: // Control Change\n      return {\n        kind: \"CC\",\n        channel,\n        data,\n        cc: data[1],\n        value: data[2],\n      };\n\n    case 0xc0: // Program Change\n      return {\n        kind: \"PC\",\n        channel,\n        data,\n        program: data[1],\n      };\n\n    case 0xe0: // Pitch Bend\n      const value14bit = data[1] | (data[2] << 7);\n      return {\n        kind: \"PB\",\n        channel,\n        data,\n        pitchBend: value14bit - 8192,\n      };\n\n    default:\n      // System messages\n      if (status === 0xf8) return { kind: \"CLOCK\", data };\n      if (status === 0xfa) return { kind: \"START\", data };\n      if (status === 0xfc) return { kind: \"STOP\", data };\n      if (status === 0xfb) return { kind: \"CONTINUE\", data };\n      if (status === 0xf0) return { kind: \"SYSEX\", data };\n      \n      return { kind: \"OTHER\", data };\n  }\n}\n\nexport function formatMidiMessage(midi: MidiData): string {\n  switch (midi.kind) {\n    case \"NOTE_ON\":\n      return `NOTE_ON  ch${midi.channel} note=${midi.note} (${midiNoteToName(midi.note!)}) vel=${midi.vel}`;\n    case \"NOTE_OFF\":\n      return `NOTE_OFF ch${midi.channel} note=${midi.note} (${midiNoteToName(midi.note!)}) vel=${midi.vel}`;\n    case \"CC\":\n      return `CC       ch${midi.channel} cc=${midi.cc} val=${midi.value}`;\n    case \"PC\":\n      return `PC       ch${midi.channel} program=${midi.program}`;\n    case \"PB\":\n      return `PB       ch${midi.channel} value=${midi.pitchBend}`;\n    case \"CLOCK\":\n      return \"CLOCK\";\n    case \"START\":\n      return \"START\";\n    case \"STOP\":\n      return \"STOP\";\n    case \"CONTINUE\":\n      return \"CONTINUE\";\n    case \"SYSEX\":\n      return `SYSEX    len=${midi.data.length}`;\n    default:\n      return `OTHER    ${midi.data.map(b => b.toString(16).padStart(2, '0')).join(' ')}`;\n  }\n}\n\nexport function formatTime(ms: number): string {\n  const date = new Date(ms);\n  const hours = date.getHours().toString().padStart(2, '0');\n  const minutes = date.getMinutes().toString().padStart(2, '0');\n  const seconds = date.getSeconds().toString().padStart(2, '0');\n  const millis = date.getMilliseconds().toString().padStart(3, '0');\n  return `${hours}:${minutes}:${seconds}.${millis}`;\n}\n\nexport function formatDelta(ms: number): string {\n  if (ms < 1000) {\n    return `+${ms.toFixed(0)}ms`;\n  } else {\n    return `+${(ms / 1000).toFixed(2)}s`;\n  }\n}\n","import { EventBus } from './eventBus';\nimport { parseMidiMessage } from './types';\n\n// BLE MIDI Service UUIDs (standard BLE MIDI spec)\nconst BLE_MIDI_SERVICE = '03b80e5a-ede8-4b33-a751-6ce34ec4c700';\nconst BLE_MIDI_CHARACTERISTIC = '7772e5db-3868-4112-a1a9-f2669d106bf3';\n\nexport class BleMidiConnection {\n  private device: BluetoothDevice | null = null;\n  private characteristic: BluetoothRemoteGATTCharacteristic | null = null;\n  private eventBus: EventBus;\n  public connected = false;\n\n  constructor(eventBus: EventBus) {\n    this.eventBus = eventBus;\n  }\n\n  async connect(): Promise<void> {\n    try {\n      // Request device\n      this.device = await navigator.bluetooth.requestDevice({\n        filters: [{ services: [BLE_MIDI_SERVICE] }],\n      });\n\n      if (!this.device.gatt) {\n        throw new Error('GATT not available');\n      }\n\n      // Connect to GATT server\n      const server = await this.device.gatt.connect();\n\n      // Get MIDI service\n      const service = await server.getPrimaryService(BLE_MIDI_SERVICE);\n\n      // Get MIDI characteristic\n      this.characteristic = await service.getCharacteristic(BLE_MIDI_CHARACTERISTIC);\n\n      // Subscribe to notifications\n      await this.characteristic.startNotifications();\n      this.characteristic.addEventListener('characteristicvaluechanged', this.handleNotification.bind(this));\n\n      // Listen for disconnection\n      this.device.addEventListener('gattserverdisconnected', this.handleDisconnect.bind(this));\n\n      this.connected = true;\n      console.log('BLE MIDI connected');\n    } catch (error) {\n      console.error('BLE MIDI connection failed:', error);\n      throw error;\n    }\n  }\n\n  async disconnect(): Promise<void> {\n    if (this.device?.gatt?.connected) {\n      this.device.gatt.disconnect();\n    }\n    this.connected = false;\n  }\n\n  private handleNotification(event: Event): void {\n    const target = event.target as BluetoothRemoteGATTCharacteristic;\n    const value = target.value;\n    if (!value) return;\n\n    // Parse BLE MIDI packet\n    // Format: [header][timestamp][midi bytes...]\n    const data = new Uint8Array(value.buffer);\n    \n    // Skip header byte and timestamp byte, extract MIDI message\n    const midiBytes: number[] = [];\n    for (let i = 2; i < data.length; i++) {\n      // Skip timestamp bytes (high bit set)\n      if ((data[i] & 0x80) === 0 || i === 2) {\n        midiBytes.push(data[i]);\n      }\n    }\n\n    if (midiBytes.length > 0) {\n      const midi = parseMidiMessage(midiBytes);\n      \n      this.eventBus.emit({\n        source: 'BLE_IN',\n        text: `BLE←MIDI ${this.formatMidiBytes(midiBytes)}`,\n        tDeltaMs: 0, // Will be calculated by logger\n        midi,\n      });\n    }\n  }\n\n  private handleDisconnect(): void {\n    this.connected = false;\n    this.characteristic = null;\n    console.log('BLE MIDI disconnected');\n  }\n\n  async sendMidi(status: number, data1: number, data2?: number): Promise<void> {\n    if (!this.characteristic || !this.connected) {\n      throw new Error('BLE MIDI not connected');\n    }\n\n    // Build BLE MIDI packet\n    // Format: [header][timestamp][status][data1][data2?]\n    const header = 0x80;\n    const timestamp = 0x80; // Simplified timestamp\n    \n    const bytes = data2 !== undefined\n      ? [header, timestamp, status, data1, data2]\n      : [header, timestamp, status, data1];\n\n    await this.characteristic.writeValue(new Uint8Array(bytes));\n\n    // Log outgoing MIDI\n    const midiBytes = data2 !== undefined ? [status, data1, data2] : [status, data1];\n    const midi = parseMidiMessage(midiBytes);\n    \n    this.eventBus.emit({\n      source: 'BLE_OUT',\n      text: `BLE→MIDI ${this.formatMidiBytes(midiBytes)}`,\n      tDeltaMs: 0,\n      midi,\n    });\n  }\n\n  private formatMidiBytes(bytes: number[]): string {\n    return bytes.map(b => b.toString(16).padStart(2, '0')).join(' ');\n  }\n\n  isSupported(): boolean {\n    return 'bluetooth' in navigator;\n  }\n}\n","import { EventBus } from './eventBus';\n\nexport class SerialConnection {\n  private port: SerialPort | null = null;\n  private reader: ReadableStreamDefaultReader<string> | null = null;\n  private eventBus: EventBus;\n  private baudRate: number;\n  public connected = false;\n\n  constructor(eventBus: EventBus, baudRate = 115200) {\n    this.eventBus = eventBus;\n    this.baudRate = baudRate;\n  }\n\n  async connect(): Promise<void> {\n    try {\n      // Request serial port\n      this.port = await navigator.serial.requestPort();\n\n      // Open port\n      await this.port.open({ baudRate: this.baudRate });\n\n      this.connected = true;\n\n      // Start reading\n      this.startReading();\n\n      console.log('Serial connected');\n    } catch (error) {\n      console.error('Serial connection failed:', error);\n      throw error;\n    }\n  }\n\n  async disconnect(): Promise<void> {\n    if (this.reader) {\n      await this.reader.cancel();\n      this.reader = null;\n    }\n\n    if (this.port) {\n      await this.port.close();\n      this.port = null;\n    }\n\n    this.connected = false;\n  }\n\n  private async startReading(): Promise<void> {\n    if (!this.port || !this.port.readable) return;\n\n    const textDecoder = new TextDecoderStream();\n    const readableStreamClosed = this.port.readable.pipeTo(textDecoder.writable as any);\n    this.reader = textDecoder.readable.getReader();\n\n    let buffer = '';\n\n    try {\n      while (true) {\n        const { value, done } = await this.reader.read();\n        if (done) {\n          break;\n        }\n\n        buffer += value;\n        \n        // Process complete lines\n        const lines = buffer.split('\\n');\n        buffer = lines.pop() || ''; // Keep incomplete line in buffer\n\n        for (const line of lines) {\n          const trimmed = line.trim();\n          if (trimmed) {\n            this.eventBus.emit({\n              source: 'SERIAL_IN',\n              text: `SERIAL  ${trimmed}`,\n              tDeltaMs: 0,\n              serial: { line: trimmed },\n            });\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Serial read error:', error);\n    } finally {\n      this.reader.releaseLock();\n      await readableStreamClosed.catch(() => { /* ignore */ });\n    }\n  }\n\n  async sendCommand(command: string): Promise<void> {\n    if (!this.port || !this.port.writable) {\n      throw new Error('Serial not connected');\n    }\n\n    const writer = this.port.writable.getWriter();\n    const encoder = new TextEncoder();\n    await writer.write(encoder.encode(command + '\\n'));\n    writer.releaseLock();\n\n    // Log outgoing command\n    this.eventBus.emit({\n      source: 'SERIAL_OUT',\n      text: `SERIAL→ ${command}`,\n      tDeltaMs: 0,\n      serial: { line: command },\n    });\n  }\n\n  isSupported(): boolean {\n    return 'serial' in navigator;\n  }\n\n  setBaudRate(baudRate: number): void {\n    this.baudRate = baudRate;\n  }\n}\n","import type { LogEntry, LogSource } from './types';\nimport { formatTime, formatDelta, formatMidiMessage } from './types';\nimport { EventBus } from './eventBus';\n\nexport interface LoggerConfig {\n  maxEntries: number;\n  autoScroll: boolean;\n  showDelta: boolean;\n  filters: Set<LogSource>;\n  searchTerm: string;\n}\n\nexport class Logger {\n  private entries: LogEntry[] = [];\n  private config: LoggerConfig;\n  private paused = false;\n  private lastEntryTime = 0;\n  private eventBus: EventBus;\n\n  constructor(eventBus: EventBus, config: Partial<LoggerConfig> = {}) {\n    this.eventBus = eventBus;\n    this.config = {\n      maxEntries: config.maxEntries || 10000,\n      autoScroll: config.autoScroll !== false,\n      showDelta: config.showDelta !== false,\n      filters: config.filters || new Set(['BLE_IN', 'BLE_OUT', 'SERIAL_IN', 'UI_TO_MIDI']),\n      searchTerm: config.searchTerm || '',\n    };\n\n    // Subscribe to event bus\n    this.eventBus.subscribe((entry) => {\n      if (!this.paused) {\n        this.addEntry(entry);\n      }\n    });\n  }\n\n  private addEntry(entry: LogEntry): void {\n    // Calculate delta time\n    if (this.lastEntryTime > 0) {\n      entry.tDeltaMs = entry.tRelMs - this.lastEntryTime;\n    } else {\n      entry.tDeltaMs = 0;\n    }\n    this.lastEntryTime = entry.tRelMs;\n\n    // Add to ring buffer\n    this.entries.push(entry);\n    if (this.entries.length > this.config.maxEntries) {\n      this.entries.shift();\n    }\n  }\n\n  getEntries(): LogEntry[] {\n    let filtered = this.entries;\n\n    // Apply source filter\n    filtered = filtered.filter(entry => this.config.filters.has(entry.source));\n\n    // Apply search filter\n    if (this.config.searchTerm) {\n      const term = this.config.searchTerm.toLowerCase();\n      filtered = filtered.filter(entry => entry.text.toLowerCase().includes(term));\n    }\n\n    return filtered;\n  }\n\n  clear(): void {\n    this.entries = [];\n    this.lastEntryTime = 0;\n    this.eventBus.reset();\n  }\n\n  pause(): void {\n    this.paused = true;\n  }\n\n  resume(): void {\n    this.paused = false;\n  }\n\n  isPaused(): boolean {\n    return this.paused;\n  }\n\n  updateConfig(updates: Partial<LoggerConfig>): void {\n    this.config = { ...this.config, ...updates };\n  }\n\n  exportJson(): string {\n    return JSON.stringify(this.entries, null, 2);\n  }\n\n  exportCsv(): string {\n    const headers = ['Timestamp', 'Relative (ms)', 'Delta (ms)', 'Source', 'Type', 'Details'];\n    const rows = this.entries.map(entry => {\n      const details = entry.midi\n        ? formatMidiMessage(entry.midi)\n        : entry.serial?.line || '';\n      \n      return [\n        formatTime(entry.tAbsMs),\n        entry.tRelMs.toFixed(3),\n        entry.tDeltaMs.toFixed(3),\n        entry.source,\n        entry.midi?.kind || 'SERIAL',\n        details,\n      ];\n    });\n\n    const csvRows = [headers, ...rows];\n    return csvRows.map(row => row.map(cell => `\"${cell}\"`).join(',')).join('\\n');\n  }\n\n  formatEntry(entry: LogEntry): string {\n    let output = '';\n\n    // Timestamp\n    output += `<span class=\"timestamp\">${formatTime(entry.tAbsMs)}</span>`;\n\n    // Delta time (optional)\n    if (this.config.showDelta && entry.tDeltaMs > 0) {\n      output += `<span class=\"timestamp\"> ${formatDelta(entry.tDeltaMs)}</span>`;\n    }\n\n    // Source\n    const sourceLabel = this.formatSource(entry.source);\n    output += `<span class=\"source\">${sourceLabel}</span>`;\n\n    // Message details\n    if (entry.midi) {\n      output += formatMidiMessage(entry.midi);\n    } else if (entry.serial) {\n      output += entry.serial.line;\n    } else {\n      output += entry.text;\n    }\n\n    return output;\n  }\n\n  private formatSource(source: LogSource): string {\n    switch (source) {\n      case 'UI_TO_MIDI':\n        return 'UI→MIDI';\n      case 'BLE_IN':\n        return 'CYD←BLE';\n      case 'BLE_OUT':\n        return 'CYD→BLE';\n      case 'SERIAL_IN':\n        return 'CYD→SER';\n      case 'SERIAL_OUT':\n        return 'SER→CYD';\n    }\n  }\n\n  getSourceClass(source: LogSource): string {\n    switch (source) {\n      case 'UI_TO_MIDI':\n      case 'BLE_OUT':\n        return 'midi-out';\n      case 'BLE_IN':\n        return 'midi-in';\n      case 'SERIAL_IN':\n      case 'SERIAL_OUT':\n        return 'serial-in';\n    }\n  }\n}\n","import { EventBus } from './eventBus';\nimport { BleMidiConnection } from './bleMidi';\nimport { SerialConnection } from './serial';\nimport { Logger } from './logger';\nimport type { AppSettings } from './types';\nimport { DEFAULT_SETTINGS } from './types';\n\nexport class MidiController {\n  private bleMidi: BleMidiConnection;\n  private serial: SerialConnection;\n  private logger: Logger;\n  private eventBus: EventBus;\n  private settings: AppSettings;\n  \n  // State\n  private currentOctave = 3;\n  private gateEnabled = false;\n  private accentEnabled = false;\n  private slideEnabled = false;\n  private activeNotes = new Set<number>();\n  private knobValues = new Map<string, number>();\n\n  constructor(eventBus: EventBus) {\n    this.eventBus = eventBus;\n    this.settings = { ...DEFAULT_SETTINGS };\n    this.bleMidi = new BleMidiConnection(eventBus);\n    this.serial = new SerialConnection(eventBus, this.settings.serialBaudRate);\n    this.logger = new Logger(eventBus, {\n      maxEntries: this.settings.logMaxEntries,\n      showDelta: this.settings.showDeltaTimes,\n    });\n\n    // Initialize knob values\n    Object.entries(this.settings.ccMapping).forEach(([name, cc]) => {\n      this.knobValues.set(name, 64); // Default mid value\n    });\n  }\n\n  // Connection management\n  async connectBle(): Promise<void> {\n    await this.bleMidi.connect();\n  }\n\n  async disconnectBle(): Promise<void> {\n    await this.bleMidi.disconnect();\n  }\n\n  async connectSerial(): Promise<void> {\n    await this.serial.connect();\n  }\n\n  async disconnectSerial(): Promise<void> {\n    await this.serial.disconnect();\n  }\n\n  isBleConnected(): boolean {\n    return this.bleMidi.connected;\n  }\n\n  isSerialConnected(): boolean {\n    return this.serial.connected;\n  }\n\n  // MIDI operations\n  async sendNoteOn(note: number, velocity?: number): Promise<void> {\n    const vel = velocity ?? (this.accentEnabled && this.settings.accentMode === 'velocity'\n      ? this.settings.accentVelocity\n      : 100);\n    \n    const status = 0x90 | (this.settings.midiChannel - 1);\n    await this.bleMidi.sendMidi(status, note, vel);\n    \n    this.activeNotes.add(note);\n\n    // Log UI action\n    this.eventBus.emit({\n      source: 'UI_TO_MIDI',\n      text: `UI→MIDI NOTE_ON note=${note} vel=${vel}`,\n      tDeltaMs: 0,\n      midi: {\n        kind: 'NOTE_ON',\n        channel: this.settings.midiChannel,\n        data: [status, note, vel],\n        note,\n        vel,\n      },\n    });\n  }\n\n  async sendNoteOff(note: number): Promise<void> {\n    const status = 0x80 | (this.settings.midiChannel - 1);\n    await this.bleMidi.sendMidi(status, note, 0);\n    \n    this.activeNotes.delete(note);\n\n    // Log UI action\n    this.eventBus.emit({\n      source: 'UI_TO_MIDI',\n      text: `UI→MIDI NOTE_OFF note=${note}`,\n      tDeltaMs: 0,\n      midi: {\n        kind: 'NOTE_OFF',\n        channel: this.settings.midiChannel,\n        data: [status, note, 0],\n        note,\n        vel: 0,\n      },\n    });\n  }\n\n  async sendCC(cc: number, value: number): Promise<void> {\n    const status = 0xb0 | (this.settings.midiChannel - 1);\n    await this.bleMidi.sendMidi(status, cc, value);\n\n    // Log UI action\n    this.eventBus.emit({\n      source: 'UI_TO_MIDI',\n      text: `UI→MIDI CC cc=${cc} val=${value}`,\n      tDeltaMs: 0,\n      midi: {\n        kind: 'CC',\n        channel: this.settings.midiChannel,\n        data: [status, cc, value],\n        cc,\n        value,\n      },\n    });\n  }\n\n  async allNotesOff(): Promise<void> {\n    // Send All Notes Off (CC 123)\n    const status = 0xb0 | (this.settings.midiChannel - 1);\n    await this.bleMidi.sendMidi(status, 123, 0);\n    \n    // Send All Sound Off (CC 120)\n    await this.bleMidi.sendMidi(status, 120, 0);\n\n    // Also send note offs for all active notes\n    for (const note of this.activeNotes) {\n      await this.sendNoteOff(note);\n    }\n\n    this.activeNotes.clear();\n  }\n\n  async sendTestBurst(): Promise<void> {\n    // Send a deterministic sequence for testing\n    const testSequence = [\n      // Note sequence\n      { type: 'note', note: 60, vel: 100 },\n      { type: 'delay', ms: 100 },\n      { type: 'note', note: 64, vel: 100 },\n      { type: 'delay', ms: 100 },\n      { type: 'note', note: 67, vel: 100 },\n      { type: 'delay', ms: 100 },\n      // CC sweep\n      { type: 'cc', cc: 74, value: 0 },\n      { type: 'delay', ms: 50 },\n      { type: 'cc', cc: 74, value: 64 },\n      { type: 'delay', ms: 50 },\n      { type: 'cc', cc: 74, value: 127 },\n      { type: 'delay', ms: 100 },\n      // Note offs\n      { type: 'noteOff', note: 60 },\n      { type: 'noteOff', note: 64 },\n      { type: 'noteOff', note: 67 },\n    ];\n\n    for (const item of testSequence) {\n      if (item.type === 'note') {\n        await this.sendNoteOn((item as any).note, (item as any).vel);\n      } else if (item.type === 'noteOff') {\n        await this.sendNoteOff((item as any).note);\n      } else if (item.type === 'cc') {\n        await this.sendCC((item as any).cc, (item as any).value);\n      } else if (item.type === 'delay') {\n        await new Promise(resolve => setTimeout(resolve, (item as any).ms));\n      }\n    }\n  }\n\n  // State management\n  setOctave(octave: number): void {\n    this.currentOctave = Math.max(0, Math.min(8, octave));\n  }\n\n  getOctave(): number {\n    return this.currentOctave;\n  }\n\n  toggleGate(): void {\n    this.gateEnabled = !this.gateEnabled;\n  }\n\n  isGateEnabled(): boolean {\n    return this.gateEnabled;\n  }\n\n  toggleAccent(): void {\n    this.accentEnabled = !this.accentEnabled;\n  }\n\n  isAccentEnabled(): boolean {\n    return this.accentEnabled;\n  }\n\n  toggleSlide(): void {\n    this.slideEnabled = !this.slideEnabled;\n  }\n\n  isSlideEnabled(): boolean {\n    return this.slideEnabled;\n  }\n\n  setKnobValue(name: string, value: number): void {\n    this.knobValues.set(name, value);\n  }\n\n  getKnobValue(name: string): number {\n    return this.knobValues.get(name) || 64;\n  }\n\n  // Logger access\n  getLogger(): Logger {\n    return this.logger;\n  }\n\n  // Settings\n  getSettings(): AppSettings {\n    return { ...this.settings };\n  }\n\n  updateSettings(updates: Partial<AppSettings>): void {\n    this.settings = { ...this.settings, ...updates };\n    \n    // Update serial baud rate if changed\n    if (updates.serialBaudRate !== undefined) {\n      this.serial.setBaudRate(updates.serialBaudRate);\n    }\n\n    // Update logger config if needed\n    if (updates.logMaxEntries !== undefined || updates.showDeltaTimes !== undefined) {\n      this.logger.updateConfig({\n        maxEntries: this.settings.logMaxEntries,\n        showDelta: this.settings.showDeltaTimes,\n      });\n    }\n  }\n}\n","import './style.css';\nimport { EventBus } from './eventBus';\nimport { MidiController } from './controller';\n\n// Initialize app\nconst eventBus = new EventBus();\nconst controller = new MidiController(eventBus);\nconst logger = controller.getLogger();\n\n// ============================================================\n// UI Elements\n// ============================================================\n\nconst $ = (id: string) => document.getElementById(id)!;\n\n// Connection buttons\nconst connectBleBtn = $('connect-ble') as HTMLButtonElement;\nconst connectSerialBtn = $('connect-serial') as HTMLButtonElement;\nconst bleStatus = $('ble-status');\nconst serialStatus = $('serial-status');\nconst bleLabel = $('ble-label');\nconst serialLabel = $('serial-label');\n\n// Keyboard\nconst keyboard = $('keyboard');\nconst octaveDisplay = $('octave-display');\nconst octDownBtn = $('oct-down');\nconst octUpBtn = $('oct-up');\n\n// Toggles\nconst gateToggle = $('gate-toggle');\nconst accentToggle = $('accent-toggle');\nconst slideToggle = $('slide-toggle');\n\n// Controls\nconst panicBtn = $('panic');\nconst testBurstBtn = $('test-burst');\n\n// Log controls - Serial\nconst searchBoxSerial = $('search-box-serial') as HTMLInputElement;\nconst autoScrollCheckSerial = $('auto-scroll-serial') as HTMLInputElement;\nconst showDeltaCheckSerial = $('show-delta-serial') as HTMLInputElement;\nconst pauseLogBtnSerial = $('pause-log-serial');\nconst clearLogBtnSerial = $('clear-log-serial');\nconst logViewerSerial = $('log-viewer-serial');\n\n// Log controls - MIDI\nconst searchBoxMidi = $('search-box-midi') as HTMLInputElement;\nconst filterMidiIn = $('filter-midi-in') as HTMLInputElement;\nconst filterMidiOut = $('filter-midi-out') as HTMLInputElement;\nconst autoScrollCheckMidi = $('auto-scroll-midi') as HTMLInputElement;\nconst showDeltaCheckMidi = $('show-delta-midi') as HTMLInputElement;\nconst pauseLogBtnMidi = $('pause-log-midi');\nconst clearLogBtnMidi = $('clear-log-midi');\nconst exportJsonBtn = $('export-json');\nconst exportCsvBtn = $('export-csv');\nconst logViewerMidi = $('log-viewer-midi');\n\n// Knobs container\nconst knobsGrid = $('knobs-grid');\n\n// ============================================================\n// Keyboard Setup\n// ============================================================\n\nconst whiteKeys = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];\nconst blackKeyPositions = [1, 2, 4, 5, 6]; // After C, D, F, G, A\n\nfunction createKeyboard(): void {\n  keyboard.innerHTML = '';\n  \n  // Create one octave of keys\n  for (let i = 0; i < 7; i++) {\n    const note = i * 2 + (i >= 3 ? -1 : 0); // C=0, D=2, E=4, F=5, G=7, A=9, B=11\n    \n    // White key\n    const whiteKey = document.createElement('div');\n    whiteKey.className = 'key';\n    whiteKey.dataset.note = note.toString();\n    keyboard.appendChild(whiteKey);\n    \n    // Black key (if applicable)\n    if (blackKeyPositions.includes(i)) {\n      const blackKey = document.createElement('div');\n      blackKey.className = 'key black';\n      blackKey.dataset.note = (note + 1).toString();\n      keyboard.appendChild(blackKey);\n    }\n  }\n  \n  // Add event listeners\n  keyboard.querySelectorAll('.key').forEach(key => {\n    const element = key as HTMLElement;\n    \n    element.addEventListener('mousedown', () => {\n      const note = parseInt(element.dataset.note || '0');\n      const absoluteNote = note + (controller.getOctave() * 12) + 24; // C0 = MIDI 24\n      controller.sendNoteOn(absoluteNote);\n      element.classList.add('active');\n    });\n    \n    element.addEventListener('mouseup', () => {\n      const note = parseInt(element.dataset.note || '0');\n      const absoluteNote = note + (controller.getOctave() * 12) + 24;\n      if (!controller.isGateEnabled()) {\n        controller.sendNoteOff(absoluteNote);\n      }\n      element.classList.remove('active');\n    });\n    \n    element.addEventListener('mouseleave', () => {\n      element.classList.remove('active');\n    });\n  });\n}\n\n// ============================================================\n// Knobs Setup\n// ============================================================\n\nconst knobConfigs = [\n  { name: 'cutoff', label: 'Cutoff', cc: 74 },\n  { name: 'resonance', label: 'Resonance', cc: 71 },\n  { name: 'envMod', label: 'Env Mod', cc: 75 },\n  { name: 'decay', label: 'Decay', cc: 76 },\n  { name: 'accent', label: 'Accent', cc: 77 },\n  { name: 'volume', label: 'Volume', cc: 7 },\n];\n\nfunction createKnobs(): void {\n  knobsGrid.innerHTML = '';\n  \n  knobConfigs.forEach(config => {\n    const container = document.createElement('div');\n    container.className = 'knob-container';\n    \n    const knob = document.createElement('div');\n    knob.className = 'knob';\n    knob.dataset.name = config.name;\n    \n    const label = document.createElement('div');\n    label.className = 'knob-label';\n    label.textContent = config.label;\n    \n    const value = document.createElement('div');\n    value.className = 'knob-value';\n    value.id = `knob-value-${config.name}`;\n    value.textContent = '64';\n    \n    container.appendChild(knob);\n    container.appendChild(label);\n    container.appendChild(value);\n    knobsGrid.appendChild(container);\n    \n    // Knob interaction\n    let isDragging = false;\n    let startY = 0;\n    let startValue = 64;\n    \n    knob.addEventListener('mousedown', (e) => {\n      isDragging = true;\n      startY = e.clientY;\n      startValue = controller.getKnobValue(config.name);\n      e.preventDefault();\n    });\n    \n    document.addEventListener('mousemove', (e) => {\n      if (!isDragging) return;\n      \n      const deltaY = startY - e.clientY; // Inverted\n      const newValue = Math.max(0, Math.min(127, startValue + Math.floor(deltaY / 2)));\n      \n      controller.setKnobValue(config.name, newValue);\n      value.textContent = newValue.toString();\n      \n      // Update knob rotation\n      const rotation = (newValue / 127) * 270 - 135; // -135 to +135 degrees\n      knob.style.transform = `rotate(${rotation}deg)`;\n      \n      // Send CC (with rate limiting)\n      controller.sendCC(config.cc, newValue);\n    });\n    \n    document.addEventListener('mouseup', () => {\n      isDragging = false;\n    });\n  });\n}\n\n// ============================================================\n// Event Handlers\n// ============================================================\n\nconnectBleBtn.addEventListener('click', async () => {\n  try {\n    await controller.connectBle();\n    updateConnectionStatus();\n  } catch (error) {\n    alert(`BLE connection failed: ${error}`);\n  }\n});\n\nconnectSerialBtn.addEventListener('click', async () => {\n  try {\n    await controller.connectSerial();\n    updateConnectionStatus();\n  } catch (error) {\n    alert(`Serial connection failed: ${error}`);\n  }\n});\n\noctDownBtn.addEventListener('click', () => {\n  controller.setOctave(controller.getOctave() - 1);\n  octaveDisplay.textContent = controller.getOctave().toString();\n});\n\noctUpBtn.addEventListener('click', () => {\n  controller.setOctave(controller.getOctave() + 1);\n  octaveDisplay.textContent = controller.getOctave().toString();\n});\n\ngateToggle.addEventListener('click', () => {\n  controller.toggleGate();\n  gateToggle.classList.toggle('active');\n});\n\naccentToggle.addEventListener('click', () => {\n  controller.toggleAccent();\n  accentToggle.classList.toggle('active');\n});\n\nslideToggle.addEventListener('click', () => {\n  controller.toggleSlide();\n  slideToggle.classList.toggle('active');\n});\n\npanicBtn.addEventListener('click', () => {\n  controller.allNotesOff();\n});\n\ntestBurstBtn.addEventListener('click', () => {\n  controller.sendTestBurst();\n});\n\n// Log controls - Serial\nsearchBoxSerial.addEventListener('input', () => {\n  renderSerialLog();\n});\n\nautoScrollCheckSerial.addEventListener('change', () => {\n  // Auto-scroll is handled per render\n});\n\nshowDeltaCheckSerial.addEventListener('change', () => {\n  renderSerialLog();\n});\n\npauseLogBtnSerial.addEventListener('click', () => {\n  if (logger.isPaused()) {\n    logger.resume();\n    pauseLogBtnSerial.textContent = 'Pause';\n    pauseLogBtnMidi.textContent = 'Pause';\n  } else {\n    logger.pause();\n    pauseLogBtnSerial.textContent = 'Resume';\n    pauseLogBtnMidi.textContent = 'Resume';\n  }\n});\n\nclearLogBtnSerial.addEventListener('click', () => {\n  logger.clear();\n  renderSerialLog();\n  renderMidiLog();\n});\n\n// Log controls - MIDI\nsearchBoxMidi.addEventListener('input', () => {\n  renderMidiLog();\n});\n\nfilterMidiIn.addEventListener('change', () => {\n  renderMidiLog();\n});\n\nfilterMidiOut.addEventListener('change', () => {\n  renderMidiLog();\n});\n\nautoScrollCheckMidi.addEventListener('change', () => {\n  // Auto-scroll is handled per render\n});\n\nshowDeltaCheckMidi.addEventListener('change', () => {\n  renderMidiLog();\n});\n\npauseLogBtnMidi.addEventListener('click', () => {\n  if (logger.isPaused()) {\n    logger.resume();\n    pauseLogBtnSerial.textContent = 'Pause';\n    pauseLogBtnMidi.textContent = 'Pause';\n  } else {\n    logger.pause();\n    pauseLogBtnSerial.textContent = 'Resume';\n    pauseLogBtnMidi.textContent = 'Resume';\n  }\n});\n\nclearLogBtnMidi.addEventListener('click', () => {\n  logger.clear();\n  renderSerialLog();\n  renderMidiLog();\n});\n\nexportJsonBtn.addEventListener('click', () => {\n  downloadFile('cyd-debug-log.json', logger.exportJson());\n});\n\nexportCsvBtn.addEventListener('click', () => {\n  downloadFile('cyd-debug-log.csv', logger.exportCsv());\n});\n\n// ============================================================\n// Rendering\n// ============================================================\n\nfunction updateConnectionStatus(): void {\n  const bleConnected = controller.isBleConnected();\n  const serialConnected = controller.isSerialConnected();\n  \n  bleStatus.classList.toggle('connected', bleConnected);\n  bleLabel.textContent = bleConnected ? 'BLE: Connected' : 'BLE: Disconnected';\n  \n  serialStatus.classList.toggle('connected', serialConnected);\n  serialLabel.textContent = serialConnected ? 'Serial: Connected' : 'Serial: Disconnected';\n  \n  connectBleBtn.textContent = bleConnected ? 'Disconnect BLE' : 'Connect BLE MIDI';\n  connectSerialBtn.textContent = serialConnected ? 'Disconnect Serial' : 'Connect Serial';\n}\n\nlet renderSerialScheduled = false;\nlet renderMidiScheduled = false;\n\nfunction renderSerialLog(): void {\n  if (renderSerialScheduled) return;\n  renderSerialScheduled = true;\n  \n  requestAnimationFrame(() => {\n    const allEntries = logger.getEntries();\n    const searchTerm = searchBoxSerial.value.toLowerCase();\n    \n    // Filter for serial entries only\n    const entries = allEntries.filter(entry => {\n      const isSerial = entry.source === 'SERIAL_IN' || entry.source === 'SERIAL_OUT';\n      if (!isSerial) return false;\n      if (searchTerm && !entry.text.toLowerCase().includes(searchTerm)) return false;\n      return true;\n    });\n    \n    const autoScroll = autoScrollCheckSerial.checked;\n    const wasAtBottom = logViewerSerial.scrollHeight - logViewerSerial.scrollTop <= logViewerSerial.clientHeight + 50;\n    \n    // Render entries\n    logViewerSerial.innerHTML = entries\n      .map(entry => {\n        const cssClass = logger.getSourceClass(entry.source);\n        const formatted = logger.formatEntry(entry);\n        return `<div class=\"log-entry ${cssClass}\">${formatted}</div>`;\n      })\n      .join('');\n    \n    // Auto-scroll if enabled and was at bottom\n    if (autoScroll && wasAtBottom) {\n      logViewerSerial.scrollTop = logViewerSerial.scrollHeight;\n    }\n    \n    renderSerialScheduled = false;\n  });\n}\n\nfunction renderMidiLog(): void {\n  if (renderMidiScheduled) return;\n  renderMidiScheduled = true;\n  \n  requestAnimationFrame(() => {\n    const allEntries = logger.getEntries();\n    const searchTerm = searchBoxMidi.value.toLowerCase();\n    \n    // Filter for MIDI entries only\n    const entries = allEntries.filter(entry => {\n      // Check filters\n      if (entry.source === 'BLE_IN' && !filterMidiIn.checked) return false;\n      if ((entry.source === 'BLE_OUT' || entry.source === 'UI_TO_MIDI') && !filterMidiOut.checked) return false;\n      \n      const isMidi = entry.source === 'BLE_IN' || entry.source === 'BLE_OUT' || entry.source === 'UI_TO_MIDI';\n      if (!isMidi) return false;\n      if (searchTerm && !entry.text.toLowerCase().includes(searchTerm)) return false;\n      return true;\n    });\n    \n    const autoScroll = autoScrollCheckMidi.checked;\n    const wasAtBottom = logViewerMidi.scrollHeight - logViewerMidi.scrollTop <= logViewerMidi.clientHeight + 50;\n    \n    // Render entries\n    logViewerMidi.innerHTML = entries\n      .map(entry => {\n        const cssClass = logger.getSourceClass(entry.source);\n        const formatted = logger.formatEntry(entry);\n        return `<div class=\"log-entry ${cssClass}\">${formatted}</div>`;\n      })\n      .join('');\n    \n    // Auto-scroll if enabled and was at bottom\n    if (autoScroll && wasAtBottom) {\n      logViewerMidi.scrollTop = logViewerMidi.scrollHeight;\n    }\n    \n    renderMidiScheduled = false;\n  });\n}\n\n// Subscribe to log updates\neventBus.subscribe(() => {\n  renderSerialLog();\n  renderMidiLog();\n});\n\nfunction downloadFile(filename: string, content: string): void {\n  const blob = new Blob([content], { type: 'text/plain' });\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = filename;\n  a.click();\n  URL.revokeObjectURL(url);\n}\n\n// ============================================================\n// Initialization\n// ============================================================\n\ncreateKeyboard();\ncreateKnobs();\nupdateConnectionStatus();\n\nconsole.log('aCYD-MIDI Web Debug Console initialized');\n"],"names":["EventBus","__publicField","callback","index","entry","fullEntry","DEFAULT_SETTINGS","midiNoteToName","note","names","octave","parseMidiMessage","data","status","messageType","channel","value14bit","formatMidiMessage","midi","b","formatTime","ms","date","hours","minutes","seconds","millis","formatDelta","BLE_MIDI_SERVICE","BLE_MIDI_CHARACTERISTIC","BleMidiConnection","eventBus","service","error","_b","_a","event","value","midiBytes","i","data1","data2","header","timestamp","bytes","SerialConnection","baudRate","textDecoder","readableStreamClosed","buffer","done","lines","line","trimmed","command","writer","encoder","Logger","config","filtered","term","updates","headers","rows","details","row","cell","output","sourceLabel","source","MidiController","name","cc","velocity","vel","testSequence","item","resolve","controller","logger","$","id","connectBleBtn","connectSerialBtn","bleStatus","serialStatus","bleLabel","serialLabel","keyboard","octaveDisplay","octDownBtn","octUpBtn","gateToggle","accentToggle","slideToggle","panicBtn","testBurstBtn","searchBoxSerial","autoScrollCheckSerial","showDeltaCheckSerial","pauseLogBtnSerial","clearLogBtnSerial","logViewerSerial","searchBoxMidi","filterMidiIn","filterMidiOut","autoScrollCheckMidi","showDeltaCheckMidi","pauseLogBtnMidi","clearLogBtnMidi","exportJsonBtn","exportCsvBtn","logViewerMidi","knobsGrid","blackKeyPositions","createKeyboard","whiteKey","blackKey","key","element","absoluteNote","knobConfigs","createKnobs","container","knob","label","isDragging","startY","startValue","e","deltaY","newValue","rotation","updateConnectionStatus","renderSerialLog","renderMidiLog","downloadFile","bleConnected","serialConnected","renderSerialScheduled","renderMidiScheduled","allEntries","searchTerm","entries","autoScroll","wasAtBottom","cssClass","formatted","filename","content","blob","url","a"],"mappings":"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"}